{"version":3,"file":"utils-9e2add98.js","sources":["../../node_modules/@arcgis/core/views/2d/engine/webgl/techniques/Technique.js","../../node_modules/@arcgis/core/views/2d/engine/webgl/techniques/dotDensity/TechniqueDotDensity.js","../../node_modules/@arcgis/core/views/2d/engine/webgl/techniques/heatmap/TechniqueHeatmap.js","../../node_modules/@arcgis/core/views/2d/engine/webgl/techniques/pieChart/TechniquePieChart.js","../../node_modules/@arcgis/core/views/2d/engine/webgl/techniques/utils.js"],"sourcesContent":["/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.26/esri/copyright.txt for details.\n*/\nimport{isSome as t}from\"../../../../../core/maybe.js\";class e{static getStorageSpec(t){return null}static createOrUpdateRendererSchema(e,r){return t(e)&&\"default\"===e.type?e:{type:\"default\"}}static getVariation(t){return{}}static getVariationHash(t){return 0}}e.type=\"default\",e.programSpec=null;export{e as Technique};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.26/esri/copyright.txt for details.\n*/\nimport{isSome as e}from\"../../../../../../core/maybe.js\";import{writeColor as t}from\"../../color.js\";import{DOT_DENSITY_MAX_FIELDS as o}from\"../../definitions.js\";import{Technique as r}from\"../Technique.js\";import{DataType as a}from\"../../../../../webgl/enums.js\";class n extends r{static getStorageSpec({attributes:e}){return{visualVariables:!1,attributes:e??null}}static _createRendererSchema(){return{type:\"dot-density\",colors:new Float32Array(32),dotValue:-1,dotSize:-1,dotScale:-1,dotBlending:!1,backgroundColor:new Float32Array(4),activeDots:new Float32Array(8),seed:-1}}static createOrUpdateRendererSchema(r,a){const{attributes:n,dotValue:i,referenceScale:d,dotSize:l,dotBlendingEnabled:s,seed:c,backgroundColor:u}=a,m=e(r)&&\"dot-density\"===r.type?r:this._createRendererSchema();m.dotValue=i,m.dotSize=l,m.dotScale=d,m.dotBlending=s,m.seed=c;const{colors:g,activeDots:p,backgroundColor:y}=m;for(let e=0;e<o;e++){const o=e>=n.length?null:n[e].color;t(g,o,4*e)}for(let e=0;e<8;e++)p[e]=e<a.attributes.length?1:0;return t(y,u),m}static getVariation(e){return{ddDotBlending:e.dotBlending}}static getVariationHash(e){return e.dotBlending?1:0}}n.type=\"dot-density\",n.programSpec={shader:\"materials/fill\",vertexLayout:{geometry:[{location:0,name:\"a_pos\",count:2,type:a.SHORT},{location:1,name:\"a_id\",count:3,type:a.UNSIGNED_BYTE},{location:2,name:\"a_bitset\",count:1,type:a.UNSIGNED_BYTE},{location:3,name:\"a_inverseArea\",count:1,type:a.FLOAT}]}};export{n as DotDensityTechnique};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.26/esri/copyright.txt for details.\n*/\nimport{isSome as e}from\"../../../../../../core/maybe.js\";import{pt2px as t}from\"../../../../../../core/screenUtils.js\";import{generateGradient as r}from\"../../../../../../renderers/support/heatmapUtils.js\";import{Technique as a}from\"../Technique.js\";import{DataType as i}from\"../../../../../webgl/enums.js\";class n extends a{static getStorageSpec({field:e,valueExpression:t}){return{visualVariables:!1,attributes:e||t?[{field:e,valueExpression:t}]:null}}static _createRendererSchema(){return{type:\"heatmap\",radius:-1,referenceScale:-1,isFieldActive:0,minDensity:-1,densityRange:-1,kernel:null,gradient:null,gradientHash:\"invalid\"}}static createOrUpdateRendererSchema(a,i){const{radius:n,minDensity:s,maxDensity:o,referenceScale:c,field:l,valueExpression:m,colorStops:p}=i,d=o-s,u=l||m?1:0,y=p.map((({color:e,ratio:t})=>`${t}:${e.toString()}`)).join();let h,S=!0;return e(a)&&\"heatmap\"===a.type?(h=a,S=y!==a.gradientHash):h=this._createRendererSchema(),h.radius=t(n),h.minDensity=s,h.densityRange=d,h.referenceScale=c,h.isFieldActive=u,S&&(h.gradient=r(p),h.gradientHash=y),h}}n.type=\"heatmap\",n.programSpec={shader:\"materials/icon/heatmapAccumulate\",vertexLayout:{geometry:[{location:0,name:\"a_pos\",count:2,type:i.SHORT},{location:1,name:\"a_vertexOffset\",count:2,type:i.SHORT},{location:4,name:\"a_id\",count:4,type:i.UNSIGNED_BYTE}]}};export{n as HeatmapTechnique};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.26/esri/copyright.txt for details.\n*/\nimport e from\"../../../../../../Color.js\";import{isSome as t}from\"../../../../../../core/maybe.js\";import{pt2px as o}from\"../../../../../../core/screenUtils.js\";import{writeColor as r}from\"../../color.js\";import{CHART_MAX_FIELDS as a}from\"../../definitions.js\";import{Technique as n}from\"../Technique.js\";import{DataType as i}from\"../../../../../webgl/enums.js\";class l extends n{static getStorageSpec({attributes:e}){return{visualVariables:!0,attributes:e??null}}static _createRendererSchema(){return{type:\"pie-chart\",colors:new Float32Array(4*a),defaultColor:new Float32Array(4),othersColor:new Float32Array(4),outlineColor:new Float32Array(4),holePercentage:0,sectorThreshold:0,outlineWidth:1,numberOfFields:10}}static createOrUpdateRendererSchema(n,i){const{attributes:l,defaultColor:s,holePercentage:c,othersCategory:m,outline:u}=i,d=t(n)&&\"pie-chart\"===n.type?n:this._createRendererSchema();for(let t=0;t<a;t++){const o=t>=l.length?new e([0,0,0,0]):l[t].color;r(d.colors,o,4*t)}return r(d.defaultColor,s),r(d.othersColor,m?.color),r(d.outlineColor,u?.color),d.outlineWidth=o(u?.width||0),d.holePercentage=c,d.sectorThreshold=m?.threshold||0,d.numberOfFields=l.length,d}static getVariation(e){return{numberOfFields:e.numberOfFields}}static getVariationHash(e){return e.numberOfFields}}l.type=\"pie-chart\",l.programSpec={shader:\"materials/pie\",vertexLayout:{geometry:[{location:0,name:\"a_pos\",count:2,type:i.SHORT},{location:1,name:\"a_vertexOffset\",count:2,type:i.SHORT},{location:2,name:\"a_texCoords\",count:2,type:i.UNSIGNED_SHORT},{location:3,name:\"a_bitSetAndDistRatio\",count:2,type:i.UNSIGNED_SHORT},{location:4,name:\"a_id\",count:4,type:i.UNSIGNED_BYTE},{location:5,name:\"a_color\",count:4,type:i.UNSIGNED_BYTE,normalized:!0},{location:6,name:\"a_outlineColor\",count:4,type:i.UNSIGNED_BYTE,normalized:!0},{location:7,name:\"a_sizeAndOutlineWidth\",count:4,type:i.UNSIGNED_BYTE},{location:8,name:\"a_zoomRange\",count:2,type:i.UNSIGNED_SHORT}]},hittestAttributes:[\"a_vertexOffset\",\"a_texCoords\"]};export{l as PieChartTechnique};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.26/esri/copyright.txt for details.\n*/\nimport e from\"../../../../../core/Error.js\";import{WGLGeometryType as r,WGLSymbologyType as t}from\"../enums.js\";import{MaterialKeyBase as o}from\"../materialKey/MaterialKey.js\";import{Technique as i}from\"./Technique.js\";import{DotDensityTechnique as n}from\"./dotDensity/TechniqueDotDensity.js\";import{HeatmapTechnique as a}from\"./heatmap/TechniqueHeatmap.js\";import{PieChartTechnique as m}from\"./pieChart/TechniquePieChart.js\";function s(r,t){if(r.type!==t)throw new e(\"material-view-model:unexpected-renderer-schema\",`expected to find renderer schema of type \"${t}\" but found type \"${r.type}\"`)}function c(e){switch(e?.type){case\"dot-density\":return n;case\"heatmap\":return a;case\"pie-chart\":return m;default:return i}}function p(e){const{geometryType:s,symbologyType:c}=o.load(e);switch(s){case r.FILL:if(c===t.DOT_DENSITY)return n;break;case r.MARKER:switch(c){case t.HEATMAP:return a;case t.PIE_CHART:return m}}return i}export{s as assertRendererSchema,p as getTechniqueFromMaterialKey,c as getTechniqueFromRenderer};\n"],"names":["e","t","r","n","i","d","l","s","c","u","m","g","p","y","o","a","h","S"],"mappings":"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"}