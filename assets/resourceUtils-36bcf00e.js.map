{"version":3,"file":"resourceUtils-36bcf00e.js","sources":["../../node_modules/@arcgis/core/portal/support/resourceUtils.js"],"sourcesContent":["/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.26/esri/copyright.txt for details.\n*/\nimport e from\"../../request.js\";import t from\"../../core/Error.js\";import{get as r,isSome as a,isNone as o}from\"../../core/maybe.js\";import{join as s,getPathExtension as n}from\"../../core/urlUtils.js\";async function c(e,t={},a){await e.load(a);const o=s(e.itemUrl,\"resources\"),{start:n=1,num:c=10,sortOrder:u=\"asc\",sortField:i=\"created\"}=t,l={query:{start:n,num:c,sortOrder:u,sortField:i,token:e.apiKey},signal:r(a,\"signal\")},p=await e.portal.request(o,l);return{total:p.total,nextStart:p.nextStart,resources:p.resources.map((({created:t,size:r,resource:a})=>({created:new Date(t),size:r,resource:e.resourceFromPath(a)})))}}async function u(e,o,n,c){if(!e.hasPath())throw new t(`portal-item-resource-${o}:invalid-path`,\"Resource does not have a valid path\");const u=e.portalItem;await u.load(c);const i=s(u.userItemUrl,\"add\"===o?\"addResources\":\"updateResources\"),[l,d]=p(e.path),m=await h(n),f=new FormData;return l&&\".\"!==l&&f.append(\"resourcesPrefix\",l),a(c)&&c.compress&&f.append(\"compress\",\"true\"),f.append(\"fileName\",d),f.append(\"file\",m,d),f.append(\"f\",\"json\"),a(c)&&c.access&&f.append(\"access\",c.access),await u.portal.request(i,{method:\"post\",body:f,signal:r(c,\"signal\")}),e}async function i(e,a,o){if(!a.hasPath())throw new t(\"portal-item-resources-remove:invalid-path\",\"Resource does not have a valid path\");await e.load(o);const n=s(e.userItemUrl,\"removeResources\");await e.portal.request(n,{method:\"post\",query:{resource:a.path},signal:r(o,\"signal\")}),a.portalItem=null}async function l(e,t){await e.load(t);const a=s(e.userItemUrl,\"removeResources\");return e.portal.request(a,{method:\"post\",query:{deleteAll:!0},signal:r(t,\"signal\")})}function p(e){const t=e.lastIndexOf(\"/\");return-1===t?[\".\",e]:[e.slice(0,t),e.slice(t+1)]}function d(e){const[t,r]=m(e),[a,o]=p(t);return[a,o,r]}function m(e){const t=n(e);return o(t)?[e,\"\"]:[e.slice(0,e.length-t.length-1),`.${t}`]}async function h(t){if(t instanceof Blob)return t;return(await e(t.url,{responseType:\"blob\"})).data}function f(e,t){if(!e.hasPath())return null;const[r,,a]=d(e.path);return e.portalItem.resourceFromPath(s(r,t+a))}function w(e,t){if(!e.hasPath())return null;const[r,,a]=d(e.path);return e.portalItem.resourceFromPath(s(r,t+a))}export{u as addOrUpdateResource,h as contentToBlob,c as fetchResources,f as getSiblingOfSameType,w as getSiblingOfSameTypeI,l as removeAllResources,i as removeResource,d as splitPrefixFileNameAndExtension};\n"],"names":["c","o","s","n","u","i","l","r","p","t","a","d","m","h","f","e","w"],"mappings":"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"}