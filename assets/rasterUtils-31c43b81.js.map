{"version":3,"file":"rasterUtils-31c43b81.js","sources":["../../node_modules/@arcgis/core/views/webgl/rasterUtils.js"],"sourcesContent":["/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.26/esri/copyright.txt for details.\n*/\nimport{isNone as e}from\"../../core/maybe.js\";import{Z as t}from\"../../chunks/vec2f64.js\";import{ContextType as n}from\"./context-util.js\";import{PixelType as a,TextureType as r,PixelFormat as i,SizedPixelFormat as o,TextureSamplingMode as s,TextureWrapMode as u,UniformType as f}from\"./enums.js\";import{Texture as m}from\"./Texture.js\";function c(e,t,f=\"nearest\",c=!1){const l=!(c&&\"u8\"===t.pixelType),_=l?a.FLOAT:a.UNSIGNED_BYTE,p=null==t.pixels||0===t.pixels.length?null:l?t.getAsRGBAFloat():t.getAsRGBA(),g=e.capabilities.textureFloat?.textureFloatLinear,T={width:t.width,height:t.height,target:r.TEXTURE_2D,pixelFormat:i.RGBA,internalFormat:e.type===n.WEBGL2&&l?o.RGBA32F:i.RGBA,samplingMode:!g||\"bilinear\"!==f&&\"cubic\"!==f?s.NEAREST:s.LINEAR,dataType:_,wrapMode:u.CLAMP_TO_EDGE,flipped:!1};return new m(e,T,p)}function l(e,t){const{spacing:f,offsets:c,coefficients:l,size:[_,p]}=t,g=f[0]>1,T={width:g?4*_:_,height:p,target:r.TEXTURE_2D,pixelFormat:i.RGBA,internalFormat:e.type===n.WEBGL2?o.RGBA32F:i.RGBA,dataType:a.FLOAT,samplingMode:s.NEAREST,wrapMode:u.CLAMP_TO_EDGE,flipped:!1},E=new Float32Array(g?_*p*16:2*c.length);if(g&&null!=l)for(let n=0,a=0;n<l.length;n++)E[a++]=l[n],n%3==2&&(E[a++]=1);else for(let n=0;n<p;n++)for(let e=0;e<_;e++){const t=4*(n*_+e),a=2*(e*p+n);E[t]=c[a],E[t+1]=c[a+1],E[t+3]=-1===c[a]?0:1}return new m(e,T,E)}function _(e,t){const n={width:t.length/4,height:1,target:r.TEXTURE_2D,pixelFormat:i.RGBA,internalFormat:i.RGBA,dataType:a.UNSIGNED_BYTE,samplingMode:s.NEAREST,wrapMode:u.CLAMP_TO_EDGE,flipped:!1};return new m(e,n,t)}function p(e,n,a,r=1,i=!0){return{u_flipY:i,u_applyTransform:!!e,u_opacity:r,u_transformSpacing:e?e.spacing:t,u_transformGridSize:e?e.size:t,u_targetImageSize:n,u_srcImageSize:a}}function g(e,t){return{u_colormapOffset:t||0,u_colormapMaxIndex:e?e.length/4-1:0}}function T(e,t){return{u_scale:e,u_offset:t}}function E(e){return{u_bandCount:e.bandCount,u_minOutput:e.outMin,u_maxOutput:e.outMax,u_minCutOff:e.minCutOff,u_maxCutOff:e.maxCutOff,u_factor:e.factor,u_useGamma:e.useGamma,u_gamma:e.gamma,u_gammaCorrection:e.gammaCorrection}}function A(e){return{u_hillshadeType:e.hillshadeType,u_sinZcosAs:e.sinZcosAs,u_sinZsinAs:e.sinZsinAs,u_cosZs:e.cosZs,u_weights:e.weights,u_factor:e.factor,u_minValue:e.minValue,u_maxValue:e.maxValue}}function h(t,n){const a=t.gl,r=n.glName,i=new Map;if(e(r))return i;const o=a.getProgramParameter(r,a.ACTIVE_UNIFORMS);let s;for(let e=0;e<o;e++)s=a.getActiveUniform(r,e),s&&i.set(s.name,{location:a.getUniformLocation(r,s.name),info:s});return i}function O(e,t,n){Object.keys(n).forEach((a=>{const r=t.get(a)||t.get(a+\"[0]\");r&&x(e,a,n[a],r)}))}function d(e,t,n,a){n.length===a.length&&(a.some((e=>null==e))||n.some((e=>null==e))||n.forEach(((n,r)=>{t.setUniform1i(n,r),e.bindTexture(a[r],r)})))}function x(e,t,n,a){if(null===a||null==n)return!1;const{info:r}=a;switch(r.type){case f.FLOAT:r.size>1?e.setUniform1fv(t,n):e.setUniform1f(t,n);break;case f.FLOAT_VEC2:e.setUniform2fv(t,n);break;case f.FLOAT_VEC3:e.setUniform3fv(t,n);break;case f.FLOAT_VEC4:e.setUniform4fv(t,n);break;case f.FLOAT_MAT3:e.setUniformMatrix3fv(t,n);break;case f.FLOAT_MAT4:e.setUniformMatrix4fv(t,n);break;case f.INT:r.size>1?e.setUniform1iv(t,n):e.setUniform1i(t,n);break;case f.BOOL:e.setUniform1i(t,n?1:0);break;case f.INT_VEC2:case f.BOOL_VEC2:e.setUniform2iv(t,n);break;case f.INT_VEC3:case f.BOOL_VEC3:e.setUniform3iv(t,n);break;case f.INT_VEC4:case f.BOOL_VEC4:e.setUniform4iv(t,n);break;default:return!1}return!0}export{_ as createColormapTexture,c as createRasterTexture,l as createTransformTexture,T as getBasicGridUniforms,g as getColormapUniforms,p as getCommonUniforms,A as getShadedReliefUniforms,E as getStretchUniforms,h as getUniformLocationInfos,d as setTextures,O as setUniforms};\n"],"names":["c","f","l","_","a","p","g","_a","T","r","i","n","o","s","u","m","E","e","t","A","h","O","x","d"],"mappings":"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"}