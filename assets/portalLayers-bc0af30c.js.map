{"version":3,"file":"portalLayers-bc0af30c.js","sources":["../../node_modules/@arcgis/core/portal/support/portalLayers.js"],"sourcesContent":["/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.26/esri/copyright.txt for details.\n*/\nimport e from\"../../core/Error.js\";import{sceneServiceLayerTypeToClassName as r}from\"../../layers/support/layerUtils.js\";import{layerLookupMap as a}from\"../../layers/support/lazyLayerLoader.js\";import t from\"../PortalItem.js\";import{getNumLayersAndTables as s,preprocessFSItemData as n,getSubtypeGroupLayerIds as c,getFirstLayerOrTableId as o}from\"./layersLoader.js\";import{hasTypeKeyword as i}from\"./portalItemUtils.js\";import{fetchArcGISServiceJSON as u}from\"../../support/requestPresets.js\";async function l(e){!e.portalItem||e.portalItem instanceof t||(e={...e,portalItem:new t(e.portalItem)});const r=await y(e.portalItem);return new(0,r.constructor)({portalItem:e.portalItem,...r.properties})}async function y(e){await e.load();return p(await m(e))}async function m(r){switch(r.type){case\"Map Service\":return f(r);case\"Feature Service\":return L(r);case\"Feature Collection\":return w(r);case\"Scene Service\":return N(r);case\"Image Service\":return d(r);case\"Stream Service\":return S();case\"Vector Tile Service\":return I();case\"GeoJson\":return g();case\"CSV\":return T();case\"KML\":return v();case\"WFS\":return j();case\"WMTS\":return G();case\"WMS\":return M();case\"Feed\":return h();default:throw new e(\"portal:unknown-item-type\",\"Unknown item type '${type}'\",{type:r.type})}}async function p(e){const r=a[e.className];return{constructor:await r(),properties:e.properties}}async function f(e){return await b(e)?{className:\"TileLayer\"}:{className:\"MapImageLayer\"}}async function L(e){if(i(e,\"Oriented Imagery Layer\"))return F(e);const r=await C(e);if(\"object\"==typeof r){const e={};return null!=r.id&&(e.layerId=r.id),{className:r.className||\"FeatureLayer\",properties:e}}return{className:\"GroupLayer\"}}async function N(e){const a=await C(e);if(\"object\"==typeof a){const t={};let s;if(null!=a.id?(t.layerId=a.id,s=`${e.url}/layers/${a.id}`):s=e.url,e.typeKeywords?.length)for(const a of Object.keys(r))if(e.typeKeywords.includes(a))return{className:r[a]};const n=await u(s);return{className:r[n?.layerType]||\"SceneLayer\",properties:t}}if(!1===a){return\"Voxel\"===(await u(e.url))?.layerType?{className:\"VoxelLayer\"}:{className:\"GroupLayer\"}}return{className:\"GroupLayer\"}}async function w(e){await e.load();const r=i(e,\"Map Notes\"),a=i(e,\"Markup\");if(r||a)return{className:\"MapNotesLayer\"};if(i(e,\"Route Layer\"))return{className:\"RouteLayer\"};const t=await e.fetchData();return 1===s(t)?{className:\"FeatureLayer\"}:{className:\"GroupLayer\"}}async function d(e){await e.load();const r=e.typeKeywords?.map((e=>e.toLowerCase()))??[];if(r.includes(\"elevation 3d layer\"))return{className:\"ElevationLayer\"};if(r.includes(\"tiled imagery\"))return{className:\"ImageryTileLayer\"};const a=(await e.fetchData())?.layerType;if(\"ArcGISTiledImageServiceLayer\"===a)return{className:\"ImageryTileLayer\"};if(\"ArcGISImageServiceLayer\"===a)return{className:\"ImageryLayer\"};const t=await u(e.url),s=t.cacheType?.toLowerCase(),n=t.capabilities?.toLowerCase().includes(\"tilesonly\");return\"map\"===s||n?{className:\"ImageryTileLayer\"}:{className:\"ImageryLayer\"}}function S(){return{className:\"StreamLayer\"}}function I(){return{className:\"VectorTileLayer\"}}function g(){return{className:\"GeoJSONLayer\"}}function T(){return{className:\"CSVLayer\"}}function v(){return{className:\"KMLLayer\"}}function j(){return{className:\"WFSLayer\"}}function M(){return{className:\"WMSLayer\"}}function G(){return{className:\"WMTSLayer\"}}function h(){return{className:\"StreamLayer\"}}async function F(e){await e.load();const r=await e.fetchData();return r.coverage?{className:\"GroupLayer\"}:{className:\"OrientedImageryLayer\",properties:r}}async function b(e){return(await u(e.url)).tileInfo}async function C(e){const r=e.url;if(!r||r.match(/\\/\\d+$/))return{};await e.load();const a=await e.fetchData();if(\"Feature Service\"===e.type){const e=V(await n(a,r));if(\"object\"==typeof e){const r=c(a);e.className=null!=e.id&&r.includes(e.id)?\"SubtypeGroupLayer\":\"FeatureLayer\"}return e}if(s(a)>0)return V(a);return V(await u(r))}function V(e){return 1===s(e)&&{id:o(e)}}export{l as fromItem,m as selectLayerClassPath};\n"],"names":["l","t","r","y","p","m","f","L","w","N","d","S","I","g","T","v","j","G","M","h","e","a","b","i","F","C","s","_a","u","_b","n","V","c","o"],"mappings":"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"}