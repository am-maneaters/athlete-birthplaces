{"version":3,"file":"StreamLayerView2D-a1f6c5af.js","sources":["../../node_modules/@arcgis/core/views/2d/layers/StreamLayerView2D.js"],"sourcesContent":["/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.26/esri/copyright.txt for details.\n*/\nimport{_ as e}from\"../../../chunks/tslib.es6.js\";import t from\"../../../core/Error.js\";import{handlesGroup as r}from\"../../../core/handleUtils.js\";import{isNone as s,isSome as o}from\"../../../core/maybe.js\";import{watch as i}from\"../../../core/reactiveUtils.js\";import{property as n}from\"../../../core/accessorSupport/decorators/property.js\";import\"../../../core/accessorSupport/ensureType.js\";import\"../../../core/arrayUtils.js\";import{subclass as a}from\"../../../core/accessorSupport/decorators/subclass.js\";import c from\"../../../rest/support/FeatureSet.js\";import p from\"./FeatureLayerView2D.js\";import{toJSONGeometryType as l}from\"./support/util.js\";function u(e,t){if(s(e)&&s(t))return null;const r={};return o(t)&&(r.geometry=t.toJSON()),o(e)&&(r.where=e),r}let m=class extends p{constructor(){super(...arguments),this._enabledEventTypes=new Set,this._isUserPaused=!1,this.errorString=null,this.connectionStatus=\"disconnected\"}initialize(){this.addHandles([i((()=>this.layer.customParameters),(e=>this._proxy.updateCustomParameters(e))),this.layer.on(\"send-message-to-socket\",(e=>this._proxy.sendMessageToSocket(e))),this.layer.on(\"send-message-to-client\",(e=>this._proxy.sendMessageToClient(e))),i((()=>this.layer.purgeOptions),(()=>this._update())),i((()=>this.suspended),(e=>{e?this._proxy.pauseStream():this._isUserPaused||this._proxy.resumeStream()}))],\"constructor\")}get connectionError(){if(this.errorString)return new t(\"stream-controller\",this.errorString)}pause(){this._isUserPaused=!0,this._proxy.pauseStream()}resume(){this._isUserPaused=!1,this._proxy.resumeStream()}on(e,t){if(Array.isArray(e))return r(e.map((e=>this.on(e,t))));const s=[\"data-received\",\"message-received\"].includes(e);s&&(this._enabledEventTypes.add(e),this._proxy.enableEvent(e,!0));const o=super.on(e,t),i=this;return{remove(){o.remove(),s&&(i._proxy.closed||i.hasEventListener(e)||i._proxy.enableEvent(e,!1))}}}queryLatestObservations(e,r){if(!(this.layer.timeInfo?.endField||this.layer.timeInfo?.startField||this.layer.timeInfo?.trackIdField))throw new t(\"streamlayer-no-timeField\",\"queryLatestObservation can only be used with services that define a TrackIdField\");return this._proxy.queryLatestObservations(this._cleanUpQuery(e),r).then((e=>{const t=c.fromJSON(e);return t.features.forEach((e=>{e.layer=this.layer,e.sourceLayer=this.layer})),t}))}detach(){super.detach(),this.connectionStatus=\"disconnected\"}_createClientOptions(){return{...super._createClientOptions(),setProperty:e=>{this.set(e.propertyName,e.value)}}}_createTileRendererHash(e){const t=`${JSON.stringify(this.layer.purgeOptions)}.${JSON.stringify(u(this.layer.definitionExpression,this.layer.geometryDefinition))})`;return super._createTileRendererHash(e)+t}async _createServiceOptions(){const e=this.layer,{objectIdField:t}=e,r=e.fields.map((e=>e.toJSON())),s=l(e.geometryType),o=e.timeInfo&&e.timeInfo.toJSON()||null,i=e.spatialReference?e.spatialReference.toJSON():null;return{type:\"stream\",fields:r,geometryType:s,objectIdField:t,timeInfo:o,source:this.layer.parsedUrl,serviceFilter:u(this.layer.definitionExpression,this.layer.geometryDefinition),purgeOptions:this.layer.purgeOptions.toJSON(),enabledEventTypes:Array.from(this._enabledEventTypes.values()),spatialReference:i,maxReconnectionAttempts:this.layer.maxReconnectionAttempts,maxReconnectionInterval:this.layer.maxReconnectionInterval,updateInterval:this.layer.updateInterval,customParameters:e.customParameters}}};e([n()],m.prototype,\"errorString\",void 0),e([n({readOnly:!0})],m.prototype,\"connectionError\",null),e([n()],m.prototype,\"connectionStatus\",void 0),m=e([a(\"esri.views.2d.layers.StreamLayerView2D\")],m);const y=m;export{y as default};\n"],"names":["u","t","s","o","m","p","i","r","e","_a","_b","_c","c","l","n","a","y"],"mappings":"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"}