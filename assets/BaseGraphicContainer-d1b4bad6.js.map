{"version":3,"file":"BaseGraphicContainer-d1b4bad6.js","sources":["../../node_modules/@arcgis/core/views/2d/layers/graphics/GraphicBoundsRenderer.js","../../node_modules/@arcgis/core/views/2d/layers/graphics/BaseGraphicContainer.js"],"sourcesContent":["/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.26/esri/copyright.txt for details.\n*/\nimport{disposeMaybe as t}from\"../../../../core/maybe.js\";import{g as e,m as r,h as s,d as i,r as o}from\"../../../../chunks/mat3.js\";import{c as a}from\"../../../../chunks/mat3f32.js\";import{f as n}from\"../../../../chunks/vec2f32.js\";import{f}from\"../../../../chunks/vec3f32.js\";import{normalizeMapX as l}from\"../../../../geometry/support/normalizeUtils.js\";import{DisplayObject as u}from\"../../engine/DisplayObject.js\";import{createProgramDescriptor as _}from\"../../engine/webgl/Utils.js\";import{BufferObject as c}from\"../../../webgl/BufferObject.js\";import{BlendFactor as h,PrimitiveType as m,DataType as d,Usage as p}from\"../../../webgl/enums.js\";import{VertexArrayObject as g}from\"../../../webgl/VertexArrayObject.js\";const v=Math.PI/180,x=4;class b extends u{constructor(t){super(),this._program=null,this._vao=null,this._vertexBuffer=null,this._indexBuffer=null,this._dvsMat3=a(),this._localOrigin={x:0,y:0},this._getBounds=t}destroy(){this._vao&&(this._vao.dispose(!0),this._vao=null,this._vertexBuffer=null,this._indexBuffer=null),this._program=t(this._program)}doRender(t){const{context:e}=t,r=this._getBounds();if(r.length<1)return;this._createShaderProgram(e),this._updateMatricesAndLocalOrigin(t),this._updateBufferData(e,r),e.setBlendingEnabled(!0),e.setDepthTestEnabled(!1),e.setStencilWriteMask(0),e.setStencilTestEnabled(!1),e.setBlendFunction(h.ONE,h.ONE_MINUS_SRC_ALPHA),e.setColorMask(!0,!0,!0,!0);const s=this._program;e.bindVAO(this._vao),e.useProgram(s),s.setUniformMatrix3fv(\"u_dvsMat3\",this._dvsMat3),e.gl.lineWidth(1),e.drawElements(m.LINES,8*r.length,d.UNSIGNED_INT,0),e.bindVAO()}_createTransforms(){return{dvs:a()}}_createShaderProgram(t){if(this._program)return;const e=\"precision highp float;\\n        uniform mat3 u_dvsMat3;\\n\\n        attribute vec2 a_position;\\n\\n        void main() {\\n          mediump vec3 pos = u_dvsMat3 * vec3(a_position, 1.0);\\n          gl_Position = vec4(pos.xy, 0.0, 1.0);\\n        }\",r=\"precision mediump float;\\n      void main() {\\n        gl_FragColor = vec4(0.75, 0.0, 0.0, 0.75);\\n      }\";this._program=t.programCache.acquire(e,r,y().attributes)}_updateMatricesAndLocalOrigin(t){const{state:a}=t,{displayMat3:u,size:_,resolution:c,pixelRatio:h,rotation:m,viewpoint:d}=a,p=v*m,{x:g,y:x}=d.targetGeometry,b=l(g,a.spatialReference);this._localOrigin.x=b,this._localOrigin.y=x;const y=h*_[0],B=h*_[1],M=c*y,j=c*B,A=e(this._dvsMat3);r(A,A,u),s(A,A,n(y/2,B/2)),i(A,A,f(_[0]/M,-B/j,1)),o(A,A,-p)}_updateBufferData(t,e){const{x:r,y:s}=this._localOrigin,i=2*x*e.length,o=new Float32Array(i),a=new Uint32Array(8*e.length);let n=0,f=0;for(const l of e)l&&(o[2*n+0]=l[0]-r,o[2*n+1]=l[1]-s,o[2*n+2]=l[0]-r,o[2*n+3]=l[3]-s,o[2*n+4]=l[2]-r,o[2*n+5]=l[3]-s,o[2*n+6]=l[2]-r,o[2*n+7]=l[1]-s,a[f+0]=n+0,a[f+1]=n+3,a[f+2]=n+3,a[f+3]=n+2,a[f+4]=n+2,a[f+5]=n+1,a[f+6]=n+1,a[f+7]=n+0,n+=4,f+=8);if(this._vertexBuffer?this._vertexBuffer.setData(o.buffer):this._vertexBuffer=c.createVertex(t,p.DYNAMIC_DRAW,o.buffer),this._indexBuffer?this._indexBuffer.setData(a):this._indexBuffer=c.createIndex(t,p.DYNAMIC_DRAW,a),!this._vao){const e=y();this._vao=new g(t,e.attributes,e.bufferLayouts,{geometry:this._vertexBuffer},this._indexBuffer)}}}const y=()=>_(\"bounds\",{geometry:[{location:0,name:\"a_position\",count:2,type:d.FLOAT}]});export{b as default};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.26/esri/copyright.txt for details.\n*/\nimport{destroyMaybe as e}from\"../../../../core/maybe.js\";import{FeatureContainer as t}from\"../../engine/FeatureContainer.js\";import r from\"./GraphicBoundsRenderer.js\";import{CompareFunction as s}from\"../../../webgl/enums.js\";let n=class extends t{constructor(e){super(e),this.hasHighlight=()=>!0}destroy(){super.destroy(),this._boundsRenderer=e(this._boundsRenderer)}enableRenderingBounds(e){this._boundsRenderer=new r(e),this.requestRender()}get hasLabels(){return!1}onTileData(e,t){e.patch(t),this.contains(e)||this.addChild(e),this.requestRender()}onTileError(e){e.clear(),this.contains(e)||this.addChild(e)}_renderChildren(e,t){for(const r of this.children)r.isReady&&r.hasData&&(r.commit(e),e.context.setStencilFunction(s.EQUAL,r.stencilRef,255),r.getDisplayList().replay(e,r,t))}};export{n as default};\n"],"names":["v","x","b","u","t","a","e","r","h","s","m","d","y","_","c","p","g","l","B","M","j","A","n","i","f","o"],"mappings":"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"}