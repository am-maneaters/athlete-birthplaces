{"version":3,"file":"GroupLayer-afd9e331.js","sources":["../../node_modules/@arcgis/core/layers/GroupLayer.js"],"sourcesContent":["/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.26/esri/copyright.txt for details.\n*/\nimport{_ as i}from\"../chunks/tslib.es6.js\";import e from\"../core/CollectionFlattener.js\";import{loadAll as t}from\"../core/loadAll.js\";import{isSome as s}from\"../core/maybe.js\";import{MultiOriginJSONMixin as r}from\"../core/MultiOriginJSONSupport.js\";import{watch as o,sync as l}from\"../core/reactiveUtils.js\";import{property as a}from\"../core/accessorSupport/decorators/property.js\";import\"../core/accessorSupport/ensureType.js\";import\"../core/arrayUtils.js\";import{getProperties as n}from\"../core/accessorSupport/utils.js\";import{subclass as p}from\"../core/accessorSupport/decorators/subclass.js\";import{writer as y}from\"../core/accessorSupport/decorators/writer.js\";import d from\"./Layer.js\";import{BlendLayer as h}from\"./mixins/BlendLayer.js\";import{OperationalLayer as c}from\"./mixins/OperationalLayer.js\";import{PortalLayer as m}from\"./mixins/PortalLayer.js\";import{ScaleRangeLayer as b}from\"./mixins/ScaleRangeLayer.js\";import{layerLookupMap as u}from\"./support/lazyLayerLoader.js\";import{createFlattenedTablesCollection as v}from\"../support/collectionUtils.js\";import{LayersMixin as f}from\"../support/LayersMixin.js\";import{TablesMixin as j}from\"../support/TablesMixin.js\";import{getLayerJSON as L}from\"../webdoc/support/writeUtils.js\";let _=class extends(h(b(c(m(j(f(r(d)))))))){constructor(i){super(i),this._visibilityHandles={},this.allLayers=new e({getCollections:()=>[this.layers],getChildrenFunction:i=>\"layers\"in i?i.layers:null}),this.allTables=v(this),this.fullExtent=void 0,this.operationalLayerType=\"GroupLayer\",this.spatialReference=void 0,this.type=\"group\"}initialize(){this._enforceVisibility(this.visibilityMode,this.visible),this.addHandles(o((()=>this.visible),this._onVisibilityChange.bind(this),l))}_writeLayers(i,e,t,r){const o=[];if(!i)return o;i.forEach((i=>{const e=L(i,r.webmap?r.webmap.getLayerJSONFromResourceInfo(i):null,r);s(e)&&e.layerType&&o.push(e)})),e.layers=o}set portalItem(i){this._set(\"portalItem\",i)}set visibilityMode(i){const e=this._get(\"visibilityMode\")!==i;this._set(\"visibilityMode\",i),e&&this._enforceVisibility(i,this.visible)}load(i){return this.addResolvingPromise(this.loadFromPortal({supportedTypes:[\"Feature Service\",\"Feature Collection\",\"Scene Service\"],layerModuleTypeMap:u},i)),Promise.resolve(this)}async loadAll(){return t(this,(i=>{i(this.layers,this.tables)}))}layerAdded(i){i.visible&&\"exclusive\"===this.visibilityMode?this._turnOffOtherLayers(i):\"inherited\"===this.visibilityMode&&(i.visible=this.visible),this._visibilityHandles[i.uid]=o((()=>i.visible),(e=>this._onChildVisibilityChange(i,e)),l)}layerRemoved(i){const e=this._visibilityHandles[i.uid];e&&(e.remove(),delete this._visibilityHandles[i.uid]),this._enforceVisibility(this.visibilityMode,this.visible)}_turnOffOtherLayers(i){this.layers.forEach((e=>{e!==i&&(e.visible=!1)}))}_enforceVisibility(i,e){if(!n(this).initialized)return;const t=this.layers;let s=t.find((i=>i.visible));switch(i){case\"exclusive\":t.length&&!s&&(s=t.getItemAt(0),s.visible=!0),this._turnOffOtherLayers(s);break;case\"inherited\":t.forEach((i=>{i.visible=e}))}}_onVisibilityChange(i){\"inherited\"===this.visibilityMode&&this.layers.forEach((e=>{e.visible=i}))}_onChildVisibilityChange(i,e){switch(this.visibilityMode){case\"exclusive\":e?this._turnOffOtherLayers(i):this._isAnyLayerVisible()||(i.visible=!0);break;case\"inherited\":i.visible=this.visible}}_isAnyLayerVisible(){return this.layers.some((i=>i.visible))}};i([a({readOnly:!0,dependsOn:[]})],_.prototype,\"allLayers\",void 0),i([a({readOnly:!0})],_.prototype,\"allTables\",void 0),i([a()],_.prototype,\"fullExtent\",void 0),i([a({json:{read:!0,write:!0}})],_.prototype,\"blendMode\",void 0),i([a({json:{read:!1,write:{ignoreOrigin:!0}}})],_.prototype,\"layers\",void 0),i([y(\"layers\")],_.prototype,\"_writeLayers\",null),i([a({type:[\"GroupLayer\"]})],_.prototype,\"operationalLayerType\",void 0),i([a({json:{origins:{\"web-document\":{read:!1,write:!1}}}})],_.prototype,\"portalItem\",null),i([a()],_.prototype,\"spatialReference\",void 0),i([a({json:{read:!1},readOnly:!0,value:\"group\"})],_.prototype,\"type\",void 0),i([a({type:[\"independent\",\"inherited\",\"exclusive\"],value:\"independent\",json:{write:!0,origins:{\"web-map\":{read:!1,write:!1}}}})],_.prototype,\"visibilityMode\",null),_=i([p(\"esri.layers.GroupLayer\")],_);const g=_;export{g as default};\n"],"names":["_","h","b","c","m","j","f","r","d","e","i","v","o","l","t","L","s","u","n","a","y","p","g"],"mappings":"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"}