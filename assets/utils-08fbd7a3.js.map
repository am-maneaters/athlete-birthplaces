{"version":3,"file":"utils-08fbd7a3.js","sources":["../../node_modules/@arcgis/core/layers/graphics/data/utils.js"],"sourcesContent":["/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.26/esri/copyright.txt for details.\n*/\nimport{JSONMap as e}from\"../../../core/jsonMap.js\";import{isNone as t,isSome as i}from\"../../../core/maybe.js\";import{getUnitString as r}from\"../../../core/unitUtils.js\";import{canProjectWithoutEngine as n}from\"../../../geometry/projection.js\";import{getGeometryExtent as o}from\"../../../geometry/support/extentUtils.js\";import{fromJSON as s,isExtent as a,isPolygon as l,isPolyline as m}from\"../../../geometry/support/jsonUtils.js\";import{normalizeCentralMeridian as f}from\"../../../geometry/support/normalizeUtils.js\";import{equals as u,isGeographic as c,isWebMercator as p,WGS84 as y}from\"../../../geometry/support/spatialReferenceUtils.js\";import{quantizeOptimizedGeometry as g,convertToPoint as S,generalizeOptimizedGeometry as R,removeZMValues as w,convertToPolyline as j,convertToPolygon as h,convertToMultipoint as d}from\"../featureConversionUtils.js\";import x from\"../OptimizedGeometry.js\";import{checkProjectionSupport as U,project as M}from\"./projectionSupport.js\";const O=new e({esriSRUnit_Meter:\"meters\",esriSRUnit_Kilometer:\"kilometers\",esriSRUnit_Foot:\"feet\",esriSRUnit_StatuteMile:\"miles\",esriSRUnit_NauticalMile:\"nautical-miles\",esriSRUnit_USNauticalMile:\"us-nautical-miles\"}),F=Object.freeze({}),N=new x,_=new x,G=new x,P={esriGeometryPoint:S,esriGeometryPolyline:j,esriGeometryPolygon:h,esriGeometryMultipoint:d};function b(e,i,r,n=e.hasZ,o=e.hasM){if(t(i))return null;const s=e.hasZ&&n,a=e.hasM&&o;if(r){const t=g(G,i,e.hasZ,e.hasM,\"esriGeometryPoint\",r,n,o);return S(t,s,a)}return S(i,s,a)}function v(e,r,n,o,s,a,l=r,m=n){const f=r&&l,u=n&&m,c=i(o)?\"coords\"in o?o:o.geometry:null;if(t(c))return null;if(s){let t=R(_,c,r,n,e,s,l,m);return a&&(t=g(G,t,f,u,e,a)),P[e]?.(t,f,u)??null}if(a){const t=g(G,c,r,n,e,a,l,m);return P[e]?.(t,f,u)??null}return w(N,c,r,n,l,m),P[e]?.(N,f,u)??null}async function z(e,t,i){const{outFields:r,orderByFields:n,groupByFieldsForStatistics:o,outStatistics:s}=e;if(r)for(let a=0;a<r.length;a++)r[a]=r[a].trim();if(n)for(let a=0;a<n.length;a++)n[a]=n[a].trim();if(o)for(let a=0;a<o.length;a++)o[a]=o[a].trim();if(s)for(let a=0;a<s.length;a++)s[a].onStatisticField&&(s[a].onStatisticField=s[a].onStatisticField.trim());return e.geometry&&!e.outSR&&(e.outSR=e.geometry.spatialReference),J(e,t,i)}async function J(e,i,r){if(!e)return null;let{where:n}=e;if(e.where=n=n&&n.trim(),(!n||/^1 *= *1$/.test(n)||i&&i===n)&&(e.where=null),!e.geometry)return e;let a=await Z(e);if(e.distance=0,e.units=null,\"esriSpatialRelEnvelopeIntersects\"===e.spatialRel){const{spatialReference:t}=e.geometry;a=o(a),a.spatialReference=t}if(a){await U(a.spatialReference,r),a=B(a,r);const i=(await f(s(a)))[0];if(t(i))throw F;const n=\"quantizationParameters\"in e&&e.quantizationParameters?.tolerance||\"maxAllowableOffset\"in e&&e.maxAllowableOffset||0,o=n&&A(a,r)?{densificationStep:8*n}:void 0,l=i.toJSON(),m=await M(l,l.spatialReference,r,o);if(!m)throw F;m.spatialReference=r,e.geometry=m}return e}function A(e,t){if(!e)return!1;const i=e.spatialReference;return(a(e)||l(e)||m(e))&&!u(i,t)&&!n(i,t)}function B(e,t){const i=e.spatialReference;return A(e,t)&&a(e)?{spatialReference:i,rings:[[[e.xmin,e.ymin],[e.xmin,e.ymax],[e.xmax,e.ymax],[e.xmax,e.ymin],[e.xmin,e.ymin]]]}:e}async function Z(e){const{distance:t,units:i}=e,n=e.geometry;if(null==t||\"vertexAttributes\"in n)return n;const o=n.spatialReference,s=i?O.fromJSON(i):r(o),a=o&&(c(o)||p(o))?n:await U(o,y).then((()=>M(n,y)));return(await q())(a.spatialReference,a,t,s)}async function q(){return(await import(\"../../../geometry/geometryEngineJSON.js\")).geodesicBuffer}function E(e){return e&&k in e?JSON.parse(JSON.stringify(e,C)):e}const k=\"_geVersion\",C=(e,t)=>e!==k?t:void 0;export{F as QUERY_ENGINE_EMPTY_RESULT,E as cleanFromGeometryEngine,v as getGeometry,z as normalizeQuery,J as normalizeQueryLike,b as transformCentroid};\n"],"names":["O","e","F","N","x","_","G","P","S","j","h","d","b","i","o","t","s","a","g","v","r","n","l","m","R","_a","_b","w","_c","z","J","Z","U","B","f","A","M","u","c","p","y","q","__vitePreload","E","k","C"],"mappings":"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"}