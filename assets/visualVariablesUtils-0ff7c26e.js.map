{"version":3,"file":"visualVariablesUtils-0ff7c26e.js","sources":["../../node_modules/@arcgis/core/views/2d/engine/webgl/DisplayId.js","../../node_modules/@arcgis/core/views/2d/engine/webgl/util/debug.js","../../node_modules/@arcgis/core/views/2d/layers/features/tileRenderers/support/visualVariablesUtils.js"],"sourcesContent":["/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.26/esri/copyright.txt for details.\n*/\nconst n=8388607,t=8388608,r=254,o=255,u=0,c=1,e=n=>(n&t)>>>23,f=t=>t&n,i=n=>e(n)===c?r:o;function p(n){return e(n)===c}function s(n,r){return((r?t:0)|n)>>>0}export{r as AGGREGATE_VALID_FILTERS_MASK,n as DISPLAY_ID_TEXEL_MASK,c as DISPLAY_ID_TYPE_AGGREGATE,u as DISPLAY_ID_TYPE_FEATURE,t as DISPLAY_ID_TYPE_MASK,o as NONAGGREGATE_VALID_FILTERS_MASK,s as createDisplayId,i as getDisplayIdFilterMask,f as getDisplayIdTexel,e as getDisplayIdType,p as isAggregateId};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.26/esri/copyright.txt for details.\n*/\nconst n=(n,l)=>n&&((...n)=>l.warn(\"DEBUG:\",...n))||(()=>null),l=!1;export{l as DEBUG_ATTR_UPDATES,n as createDebugLogger};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.26/esri/copyright.txt for details.\n*/\nimport{isNone as e}from\"../../../../../../core/maybe.js\";import{toPt as t,pt2px as s}from\"../../../../../../core/screenUtils.js\";import{premultiplyAlpha as n}from\"../../../../engine/webgl/color.js\";import{NAN_MAGIC_NUMBER as o}from\"../../../../engine/webgl/definitions.js\";import{WGLVVFlag as i}from\"../../../../engine/webgl/enums.js\";import{getTypeOfSizeVisualVariable as l}from\"../../../../engine/webgl/visualVariablesUtils.js\";function r(e,t){if(!e||!t)return e;switch(t){case\"radius\":case\"distance\":return 2*e;case\"diameter\":case\"width\":return e;case\"area\":return Math.sqrt(e)}return e}function a(e){return{value:e.value,size:t(e.size)}}function u(e){return(e??[]).map((e=>a(e)))}function p(e){if(\"string\"==typeof e||\"number\"==typeof e)return t(e);const s=e;return{type:\"size\",expression:s.expression,stops:u(s.stops)}}const c=e=>{const t=[],n=[],i=u(e),l=i.length;for(let r=0;r<6;r++){const e=i[Math.min(r,l-1)];t.push(e.value),n.push(null==e.size?o:s(e.size))}return{values:new Float32Array(t),sizes:new Float32Array(n)}};function f(e){const t=e&&e.length>0?{}:null,s=t?{}:null;if(!t||!s)return{vvFields:t,vvRanges:s};for(const n of e)if(n.field&&(t[n.type]=n.field),\"size\"===n.type){s.size||(s.size={});const e=n;switch(l(e)){case i.SIZE_MINMAX_VALUE:s.size.minMaxValue={minDataValue:e.minDataValue,maxDataValue:e.maxDataValue,minSize:p(e.minSize),maxSize:p(e.maxSize)};break;case i.SIZE_SCALE_STOPS:s.size.scaleStops={stops:u(e.stops)};break;case i.SIZE_FIELD_STOPS:if(e.levels){const t={};for(const s in e.levels)t[s]=c(e.levels[s]);s.size.fieldStops={type:\"level-dependent\",levels:t}}else s.size.fieldStops={type:\"static\",...c(e.stops)};break;case i.SIZE_UNIT_VALUE:s.size.unitValue={unit:e.valueUnit,valueRepresentation:e.valueRepresentation??void 0}}}else if(\"color\"===n.type)s.color=g(n);else if(\"opacity\"===n.type)s.opacity=m(n);else if(\"rotation\"===n.type){const e=n;s.rotation={type:e.rotationType}}return{vvFields:t,vvRanges:s}}function m(e){const t={values:[0,0,0,0,0,0,0,0],opacities:[0,0,0,0,0,0,0,0]};if(\"string\"==typeof e.field){if(!e.stops)return null;{if(e.stops.length>8)return null;const s=e.stops;for(let e=0;e<8;++e){const n=s[Math.min(e,s.length-1)];t.values[e]=n.value,t.opacities[e]=n.opacity}}}else{if(!(e.stops&&e.stops.length>=0))return null;{const s=e.stops&&e.stops.length>=0?e.stops[0].opacity:0;for(let e=0;e<8;e++)t.values[e]=1/0,t.opacities[e]=s}}return t}function v(e,t,s){e[4*t+0]=s.r/255,e[4*t+1]=s.g/255,e[4*t+2]=s.b/255,e[4*t+3]=s.a}function g(t){if(e(t))return null;if(t.normalizationField)return null;const s={field:null,values:[0,0,0,0,0,0,0,0],colors:[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]};if(\"string\"==typeof t.field){if(!t.stops)return null;{if(t.stops.length>8)return null;s.field=t.field;const e=t.stops;for(let t=0;t<8;++t){const n=e[Math.min(t,e.length-1)];s.values[t]=n.value,v(s.colors,t,n.color)}}}else{if(!(t.stops&&t.stops.length>=0))return null;{const e=t.stops&&t.stops.length>=0&&t.stops[0].color;for(let t=0;t<8;t++)s.values[t]=1/0,v(s.colors,t,e)}}for(let e=0;e<32;e+=4)n(s.colors,e,!0);return s}export{g as convertColorVariable,f as convertVisualVariables,r as getVisualVariableSizeValueRepresentationRatio,p as normalizeSizeElement,u as normalizeSizeStops,a as stopToSizeStop};\n"],"names":["n","t","r","o","u","c","e","f","i","p","s","l","a","g","m","v"],"mappings":"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"}